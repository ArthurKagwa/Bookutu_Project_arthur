{% extends 'company/base.html' %}

{% block title %}Dashboard - Bookutu{% endblock %}
{% block page_title %}Dashboard Overview{% endblock %}

{% block content %}
<!-- Stats Overview -->
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
    <div class="bg-white rounded-xl shadow-sm p-6 border-l-4 border-blue-500">
        <div class="flex items-center">
            <div class="p-3 rounded-lg bg-blue-100 text-blue-600">
                <i class="fas fa-ticket-alt"></i>
            </div>
            <div class="ml-4">
                <p class="text-sm font-medium text-gray-600">Today's Bookings</p>
                <h3 class="text-2xl font-bold text-gray-800">{{ today_bookings }}</h3>
            </div>
        </div>
        <div class="mt-4 flex items-center">
            <span class="bg-green-100 text-green-800 text-xs font-semibold px-2 py-1 rounded-full flex items-center">
                <i class="fas fa-arrow-up mr-1 text-xs"></i> 12.5%
            </span>
            <span class="text-xs text-gray-500 ml-2">from yesterday</span>
        </div>
    </div>
    
    <div class="bg-white rounded-xl shadow-sm p-6 border-l-4 border-green-500">
        <div class="flex items-center">
            <div class="p-3 rounded-lg bg-green-100 text-green-600">
                <i class="fas fa-bus"></i>
            </div>
            <div class="ml-4">
                <p class="text-sm font-medium text-gray-600">Active Buses</p>
                <h3 class="text-2xl font-bold text-gray-800">{{ active_buses }}</h3>
            </div>
        </div>
        <div class="mt-4 flex items-center">
            <span class="bg-green-100 text-green-800 text-xs font-semibold px-2 py-1 rounded-full flex items-center">
                <i class="fas fa-arrow-up mr-1 text-xs"></i> 8.3%
            </span>
            <span class="text-xs text-gray-500 ml-2">from last month</span>
        </div>
    </div>
    
    <div class="bg-white rounded-xl shadow-sm p-6 border-l-4 border-orange-500">
        <div class="flex items-center">
            <div class="p-3 rounded-lg bg-orange-100 text-orange-600">
                <i class="fas fa-calendar-check"></i>
            </div>
            <div class="ml-4">
                <p class="text-sm font-medium text-gray-600">Scheduled Trips</p>
                <h3 class="text-2xl font-bold text-gray-800">{{ scheduled_trips }}</h3>
            </div>
        </div>
        <div class="mt-4 flex items-center">
            <span class="bg-green-100 text-green-800 text-xs font-semibold px-2 py-1 rounded-full flex items-center">
                <i class="fas fa-arrow-up mr-1 text-xs"></i> 7.1%
            </span>
            <span class="text-xs text-gray-500 ml-2">from last week</span>
        </div>
    </div>
    
    <div class="bg-white rounded-xl shadow-sm p-6 border-l-4 border-purple-500">
        <div class="flex items-center">
            <div class="p-3 rounded-lg bg-purple-100 text-purple-600">
                <i class="fas fa-money-bill-wave"></i>
            </div>
            <div class="ml-4">
                <p class="text-sm font-medium text-gray-600">Monthly Revenue</p>
                <h3 class="text-2xl font-bold text-gray-800">UGX {{ monthly_revenue|floatformat:0 }}</h3>
            </div>
        </div>
        <div class="mt-4 flex items-center">
            <span class="bg-green-100 text-green-800 text-xs font-semibold px-2 py-1 rounded-full flex items-center">
                <i class="fas fa-arrow-up mr-1 text-xs"></i> 15.8%
            </span>
            <span class="text-xs text-gray-500 ml-2">from last month</span>
        </div>
    </div>
</div>

<!-- Recent Activity -->
<div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
    <!-- Recent Bookings -->
    <div class="bg-white rounded-xl shadow-sm p-6">
        <div class="flex items-center justify-between mb-4">
            <h3 class="text-lg font-semibold text-gray-800">Recent Bookings</h3>
            <a href="/company/bookings/" class="text-blue-600 hover:text-blue-700 text-sm font-medium">View all</a>
        </div>
        <div class="space-y-4">
            {% for booking in recent_bookings %}
            <div class="flex items-center p-3 bg-gray-50 rounded-lg">
                <div class="w-10 h-10 {% if booking.status == 'CONFIRMED' %}bg-green-100{% elif booking.status == 'PENDING' %}bg-yellow-100{% else %}bg-blue-100{% endif %} rounded-full flex items-center justify-center">
                    <i class="fas fa-ticket-alt {% if booking.status == 'CONFIRMED' %}text-green-600{% elif booking.status == 'PENDING' %}text-yellow-600{% else %}text-blue-600{% endif %}"></i>
                </div>
                <div class="ml-3 flex-1">
                    <p class="text-sm font-medium text-gray-800">{{ booking.booking_reference }}</p>
                    <p class="text-xs text-gray-500">{{ booking.trip.route.origin_city }} → {{ booking.trip.route.destination_city }} • {{ booking.trip.departure_date|date:"M d" }}, {{ booking.trip.departure_time|time:"H:i" }}</p>
                </div>
                <span class="text-xs {% if booking.status == 'CONFIRMED' %}bg-green-100 text-green-800{% elif booking.status == 'PENDING' %}bg-yellow-100 text-yellow-800{% else %}bg-blue-100 text-blue-800{% endif %} px-2 py-1 rounded-full">{{ booking.get_status_display }}</span>
            </div>
            {% empty %}
            <div class="text-center py-4 text-gray-500">
                <p>No recent bookings</p>
            </div>
            {% endfor %}
        </div>
    </div>

    <!-- Fleet Status -->
    <div class="bg-white rounded-xl shadow-sm p-6">
        <div class="flex items-center justify-between mb-4">
            <h3 class="text-lg font-semibold text-gray-800">Fleet Status</h3>
            <a href="/company/fleet/" class="text-blue-600 hover:text-blue-700 text-sm font-medium">Manage fleet</a>
        </div>
        <div class="space-y-4">
            {% for status in fleet_status %}
            <div class="flex items-center justify-between">
                <div class="flex items-center">
                    <div class="w-3 h-3 {% if status.status == 'ACTIVE' %}bg-green-500{% elif status.status == 'MAINTENANCE' %}bg-yellow-500{% else %}bg-red-500{% endif %} rounded-full mr-3"></div>
                    <span class="text-sm text-gray-700">{{ status.status|title }} Buses</span>
                </div>
                <span class="text-sm font-semibold text-gray-800">{{ status.count }}</span>
            </div>
            {% empty %}
            <div class="text-center py-4 text-gray-500">
                <p>No fleet data available</p>
            </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}